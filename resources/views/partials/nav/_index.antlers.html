<!-- Outermost container sticks to top of screen, but is most necessary because it gets set to h-screen when mobile menu is open - and is a flex col container - which allows the pop-up menu to grow from the bottom of the navbar to fill the rest of the screen -->
<div
  :class="[mobileMenuOpen ? 'h-screen' : '']"
  class="fixed top-0 left-0 z-[99] flex w-full flex-col"
  x-data="{
        mobileMenuOpen: false,
        atTopOfPage: true,
      }"
  x-init="atTopOfPage = window.scrollY <= 50
      window.addEventListener('scroll', () => {
        atTopOfPage = window.scrollY <= 50
      });
      $watch('mobileMenuOpen', (isAtTop) => {
            if (isAtTop) {
              document.body.classList.add('overflow-hidden');
            } else {
              document.body.classList.remove('overflow-hidden');
            }
      })"
>
  <!-- Container for bg color while still allowing the nav container to have padding, via the very next element/container... -->
  <nav
    :class="[
        atTopOfPage
        ? 'bg-transparent'
        : 'bg-primary-900 shadow-lg shadow-primary-900/50',
    ]"
    class="w-full text-white transition-all duration-200"
  >
    <!-- Padding / main container -->
    <div class="container mx-auto flex items-center justify-between p-4 md:p-8">
      <!-- Logos: colored and uncolored images for transparent and colored header -->
      <a href="/" class="flex max-w-[10rem] items-center md:max-w-xs">
        {{ if logo_type === 'dark' }}
        <!-- Normal / Dark -->
        {{ responsive:site_config.logo x-show="atTopOfPage" loading="eager"
        placeholder="false" }}
        <!-- -->
        {{ else }}
        <!-- Light -->
        {{ responsive:site_config.logo_light x-show="atTopOfPage"
        loading="eager" placeholder="false" }}
        <!-- -->
        {{ /if }}
        <!-- Light -->
        {{ responsive:site_config.logo_light x-show="!atTopOfPage"
        placeholder="false" loading="lazy" x-cloak="true" }}
      </a>
      <div class="flex items-center lg:space-x-8">
        <!-- Desktop Nav Items -->
        <ul
          class="hidden items-center space-x-3 font-heading text-sm font-semibold lg:flex xl:space-x-8 xl:text-xl"
        >
          {{ nav:primary }}
          <li>
            {{ if children }}
            <div
              x-data="{ open: false }"
              @click.away="open = false"
              class="relative"
              x-cloak
            >
              <button
                @click="open = !open"
                class="hidden items-center font-heading font-semibold lg:flex"
              >
                <span>{{ title }}</span>
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="ml-1 h-5 w-5 transform transition-transform duration-300 ease-in-out"
                  :class="open ? 'rotate-180' : ''"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M19 9l-7 7-7-7"
                  />
                </svg>
              </button>
              <ul
                x-show="open"
                x-transition.duration.500ms
                class="theme-rounded absolute top-full mt-4 flex flex-col items-start overflow-hidden bg-white font-heading text-sm uppercase text-gray-700 shadow"
              >
                {{ children }}
                <li class="w-full">
                  <a
                    class="inline-block w-full px-8 py-4 transition duration-150 ease-in-out hover:bg-gray-100"
                    href="{{ url }}"
                    >{{ title }}</a
                  >
                </li>
                {{ /children }}
              </ul>
            </div>
            {{ else }}
            <a href="{{ url }}">{{ title }}</a>
            {{ /if }}
          </li>
          {{ /nav:primary }}
        </ul>
        <!-- CTA -->
        <div class="hidden lg:block">
          <a href="{{ site_config:cta_url }}" class="btn"
            >{{ site_config:cta_label }}</a
          >
        </div>
        <!-- Mobile Menu Button -->
        <div class="block lg:hidden">{{ partial:nav/mobile_menu }}</div>
      </div>
    </div>
  </nav>
</div>
